@* RConfirmationModal - Generic confirmation modal component *@

<RModal Visible="@Visible"
        Size="ModalSize.Small"
        Variant="@Variant"
        Title="@Title"
        CloseOnBackdrop="@(!Processing)"
        Processing="@Processing"
        CancelText="@CancelText"
        PrimaryText="@ConfirmText"
        PrimaryIcon="@GetConfirmIcon()"
        PrimaryButtonClass="@GetConfirmButtonClass()"
        ShowPrimaryButtonSpinner="@Processing"
        OnCancel="Cancel"
        OnClose="Cancel"
        OnPrimaryAction="Confirm">
    
    <div class="flex flex-col align-center text-center gap-4">
        @if (!string.IsNullOrEmpty(IconName))
        {
            <div class="flex align-center justify-center w-12 h-12 rounded-xl @GetIconBackgroundClass()">
                <i class="material-symbols-rounded @GetIconColorClass()">@IconName</i>
            </div>
        }
        <div class="flex flex-col gap-2">
            @if (ChildContent != null)
            {
                @ChildContent
            }
            else
            {
                <p class="text-center text-base">@Message</p>
            }
        </div>
    </div>
    
</RModal>

@code {
    [Parameter] public bool Visible { get; set; }
    [Parameter] public string Title { get; set; } = "Confirm Action";
    [Parameter] public string Message { get; set; } = "Are you sure you want to proceed?";
    [Parameter] public string ConfirmText { get; set; } = "Yes";
    [Parameter] public string CancelText { get; set; } = "Cancel";
    [Parameter] public string IconName { get; set; } = "warning";
    [Parameter] public ModalVariant Variant { get; set; } = ModalVariant.Warning;
    [Parameter] public bool Processing { get; set; }
    [Parameter] public RenderFragment ChildContent { get; set; }
    [Parameter] public EventCallback OnConfirm { get; set; }
    [Parameter] public EventCallback OnCancel { get; set; }

    private async Task Confirm()
    {
        if (OnConfirm.HasDelegate)
        {
            await OnConfirm.InvokeAsync();
        }
    }

    private async Task Cancel()
    {
        if (OnCancel.HasDelegate)
        {
            await OnCancel.InvokeAsync();
        }
    }

    private string GetConfirmButtonClass() => Variant switch
    {
        ModalVariant.Destructive => "bg-error text-inverse hover:opacity-90",
        ModalVariant.Warning => "bg-warning text-inverse hover:opacity-90",
        ModalVariant.Success => "bg-success text-inverse hover:opacity-90",
        ModalVariant.Info => "bg-info text-inverse hover:opacity-90",
        _ => "bg-primary text-inverse hover:opacity-90"
    };

    private string GetConfirmIcon() => Variant switch
    {
        ModalVariant.Destructive => "delete",
        ModalVariant.Warning => "warning",
        ModalVariant.Success => "check",
        ModalVariant.Info => "info",
        _ => "check"
    };

    private string GetIconBackgroundClass() => Variant switch
    {
        ModalVariant.Destructive => "bg-error-light border border-error",
        ModalVariant.Warning => "bg-warning-light border border-warning",
        ModalVariant.Success => "bg-success-light border border-success",
        ModalVariant.Info => "bg-info-light border border-info",
        _ => "bg-info-light border border-primary"
    };

    private string GetIconColorClass() => Variant switch
    {
        ModalVariant.Destructive => "text-error",
        ModalVariant.Warning => "text-warning",
        ModalVariant.Success => "text-success",
        ModalVariant.Info => "text-info",
        _ => "text-primary"
    };
}