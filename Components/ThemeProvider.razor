@using RR.Blazor.Services
@implements IAsyncDisposable
@inject IThemeService ThemeService

@if (ChildContent != null)
{
    <CascadingValue Value="ThemeService">
        @ChildContent
    </CascadingValue>
}

@code {
    [Parameter] public RenderFragment ChildContent { get; set; }
    [Parameter] public ThemeConfiguration InitialTheme { get; set; }
    
    protected override async Task OnInitializedAsync()
    {
        if (InitialTheme != null)
        {
            await ThemeService.SetThemeAsync(InitialTheme);
        }
        
        await ThemeService.InitializeAsync();
    }
    
    public async ValueTask DisposeAsync()
    {
        if (ThemeService is IAsyncDisposable asyncDisposable)
        {
            await asyncDisposable.DisposeAsync();
        }
    }
}