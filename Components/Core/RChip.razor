@** 
<summary>
Professional chip component for tags, filters, and selections with interactive states.
Supports removable chips, selection indicators, icons, and multiple variants.
</summary>
<category>Core</category>
<complexity>Simple</complexity>
<ai-prompt>Create a chip/tag for filters, selections, or labels</ai-prompt>
<ai-common-use>filter chips, tag lists, multi-select indicators, status tags</ai-common-use>
<ai-avoid>Don't use for buttons - use RButton. Avoid for large content blocks.</ai-avoid>
<ai-pattern name="filter-chip">Clickable="true" OnClick="ToggleFilter" for interactive filters</ai-pattern>
<ai-pattern name="removable-chip">Closeable="true" OnClose="RemoveChip" for deletable tags</ai-pattern>
<ai-pattern name="selected-chip">Selected="true" for active state indication</ai-pattern>
**@
@using RR.Blazor.Enums

<span class="@GetChipClasses() d-inline-flex align-center rounded-full px-3 py-1 text-sm font-medium transition-all" @onclick="HandleClick">
    @if (!string.IsNullOrEmpty(Icon) && IconPosition == IconPosition.Start)
    {
        <i class="material-symbols-rounded chip-icon chip-icon-start text-sm mr-1">@Icon</i>
    }
    
    <span class="chip-label">@Text</span>
    
    @if (!string.IsNullOrEmpty(Icon) && IconPosition == IconPosition.End && !Closeable)
    {
        <i class="material-symbols-rounded chip-icon chip-icon-end text-sm ml-1">@Icon</i>
    }
    
    @if (Closeable)
    {
        <button class="chip-close absolute right-1 top-1-2 w-5 h-5 d-flex align-center justify-center rounded-full hover-bg-surface-elevated transition-colors" 
                @onclick:stopPropagation="true" @onclick="HandleClose" aria-label="Remove @Text">
            <i class="material-symbols-rounded text-xs">close</i>
        </button>
    }
</span>

@code {
    [Parameter] public string Text { get; set; } = "";
    [Parameter] public string Icon { get; set; }
    [Parameter] public IconPosition IconPosition { get; set; } = IconPosition.Start;
    [Parameter] public ChipVariant Variant { get; set; } = ChipVariant.Default;
    [Parameter] public ChipSize Size { get; set; } = ChipSize.Medium;
    [Parameter] public bool Clickable { get; set; }
    [Parameter] public bool Selected { get; set; }
    [Parameter] public bool Closeable { get; set; }
    [Parameter] public bool Disabled { get; set; }
    [Parameter] public EventCallback OnClick { get; set; }
    [Parameter] public EventCallback OnClose { get; set; }
    [Parameter] public string Class { get; set; }

    private string GetChipClasses()
    {
        var classes = new List<string> { "chip" };
        
        // Variant utility classes
        classes.Add(GetVariantUtilityClasses());
        
        // Size utility classes
        classes.Add(GetSizeUtilityClasses());
        
        // State utility classes
        if (Clickable && !Disabled)
        {
            classes.Add("chip-clickable cursor-pointer hover-scale-sm hover-glow-sm");
        }
        
        if (Selected)
        {
            classes.Add("chip-selected bg-primary text-on-primary shadow-md");
        }
        
        if (Closeable)
        {
            classes.Add("chip-closeable pr-8");
        }
        
        if (Disabled)
        {
            classes.Add("chip-disabled opacity-50 cursor-not-allowed");
        }
        
        if (!string.IsNullOrEmpty(Class))
        {
            classes.Add(Class);
        }
        
        return string.Join(" ", classes);
    }

    private string GetVariantUtilityClasses()
    {
        return Variant switch
        {
            ChipVariant.Primary => "chip-primary bg-primary text-on-primary",
            ChipVariant.Secondary => "chip-secondary bg-surface text-secondary border border-light",
            ChipVariant.Success => "chip-success bg-success text-on-success",
            ChipVariant.Warning => "chip-warning bg-warning text-on-warning",
            ChipVariant.Danger => "chip-error bg-error text-on-error",
            ChipVariant.Info => "chip-info bg-info text-on-info",
            _ => "chip-default bg-surface text-muted border border-light"
        };
    }

    private string GetSizeUtilityClasses()
    {
        return Size switch
        {
            ChipSize.Small => "chip-small px-2 py-0-5 text-xs min-h-6",
            ChipSize.Large => "chip-large px-4 py-2 text-base min-h-10",
            _ => "px-3 py-1 text-sm min-h-8" // Medium is default
        };
    }

    private async Task HandleClick()
    {
        if (Clickable && !Disabled && OnClick.HasDelegate)
        {
            await OnClick.InvokeAsync();
        }
    }

    private async Task HandleClose()
    {
        if (!Disabled && OnClose.HasDelegate)
        {
            await OnClose.InvokeAsync();
        }
    }
}

