@** 
<summary>
Professional avatar component for user representation with status indicators and interactive features.
Supports images, initials, icons, status badges, and notification counts with responsive sizing.
</summary>
<category>Core</category>
<complexity>Simple</complexity>
<ai-prompt>Create a professional avatar for user representation</ai-prompt>
<ai-common-use>user profiles, team members, contact lists, navigation headers</ai-common-use>
<ai-avoid>Don't use for decorative icons - use Icon component instead. Avoid for non-user content.</ai-avoid>
<ai-pattern name="user-avatar">ImageSrc="/avatar.jpg" Alt="User Name" for profile pictures</ai-pattern>
<ai-pattern name="initials-avatar">Text="JD" Variant="AvatarVariant.Primary" for text-based avatars</ai-pattern>
<ai-pattern name="status-avatar">ShowStatus="true" Status="AvatarStatus.Online" for presence indicators</ai-pattern>
<ai-pattern name="notification-avatar">ShowBadge="true" BadgeCount="3" for unread counts</ai-pattern>
<ai-pattern name="clickable-avatar">IsClickable="true" OnClick="HandleClick" for interactive avatars</ai-pattern>
**@
@using RR.Blazor.Attributes

@attribute [Component("RAvatar", Category = "Core", Complexity = ComponentComplexity.Simple)]
@attribute [AIOptimized(Prompt = "Create a professional avatar for user representation", 
                       CommonUse = "user profiles, team members, contact lists", 
                       AvoidUsage = "Don't use for decorative icons - use Icon component instead")]

<div class="avatar @GetAvatarClasses()" @onclick="HandleClick" role="@(IsClickable ? "button" : null)">
    @if (!string.IsNullOrEmpty(ImageSrc))
    {
        <img src="@ImageSrc" 
             alt="@Alt" 
             class="avatar-image @GetImageClasses()" 
             loading="lazy" />
    }
    else if (!string.IsNullOrEmpty(Icon))
    {
        <i class="material-symbols-rounded @GetIconClasses()">@Icon</i>
    }
    else if (!string.IsNullOrEmpty(Text))
    {
        <span class="avatar-text @GetTextClasses()">@Text</span>
    }
    else
    {
        <i class="material-symbols-rounded @GetIconClasses()">person</i>
    }
    
    @* Status indicator *@
    @if (ShowStatus)
    {
        <div class="avatar-status @GetStatusClasses()"></div>
    }
    
    @* Badge/Count indicator *@
    @if (ShowBadge && BadgeCount > 0)
    {
        <div class="avatar-badge @GetBadgeClasses()">
            @(BadgeCount > 99 ? "99+" : BadgeCount.ToString())
        </div>
    }
</div>

@code {
    /// <summary>Avatar size variant - determines dimensions and icon/text sizing</summary>
    /// <ai-hint>Medium is default, Large for prominent display, Small for compact layouts</ai-hint>
    [Parameter]
    [AIParameter(Hint = "Medium is default, Large for prominent display, Small for compact layouts", 
                 SuggestedValues = new[] { "ExtraSmall", "Small", "Medium", "Large", "ExtraLarge" })]
    public AvatarSize Size { get; set; } = AvatarSize.Medium;
    
    /// <summary>Avatar variant style - determines color scheme and background</summary>
    /// <ai-hint>Default for neutral, Primary for branded, Success/Warning/Error for status-based styling</ai-hint>
    [Parameter]
    [AIParameter(Hint = "Default for neutral, Primary for branded, Success/Warning/Error for status", 
                 SuggestedValues = new[] { "Default", "Primary", "Success", "Warning", "Error", "Gradient" }, 
                 IsRequired = false)]
    public AvatarVariant Variant { get; set; } = AvatarVariant.Default;
    
    /// <summary>Image source URL for profile picture</summary>
    /// <ai-hint>Use high-quality square images for best results. Falls back to text/icon if not provided</ai-hint>
    [Parameter]
    [AIParameter(Hint = "Use high-quality square images. Falls back to text/icon if not provided", IsRequired = false)]
    public string ImageSrc { get; set; }
    
    /// <summary>Image alt text for accessibility</summary>
    /// <ai-hint>Use descriptive text like "John Doe's profile picture" for screen readers</ai-hint>
    [Parameter]
    [AIParameter(Hint = "Use descriptive text like 'John Doe profile picture' for screen readers", IsRequired = false)]
    public string Alt { get; set; }
    
    /// <summary>Text content (typically initials) when no image is available</summary>
    /// <ai-hint>Use 1-2 character initials like "JD", "AB". Automatically uppercase</ai-hint>
    [Parameter]
    [AIParameter(Hint = "Use 1-2 character initials like JD, AB. Automatically uppercase", IsRequired = false)]
    public string Text { get; set; }
    
    /// <summary>Material icon name as fallback when no image or text provided</summary>
    /// <ai-hint>Common icons: person, account_circle, face, group. Defaults to "person"</ai-hint>
    [Parameter]
    [AIParameter(Hint = "Common icons: person, account_circle, face, group. Defaults to person", 
                 SuggestedValues = new[] { "person", "account_circle", "face", "group" })]
    public string Icon { get; set; }
    
    /// <summary>Whether to show status indicator dot</summary>
    /// <ai-hint>Use for presence indicators in chat, team lists, or user directories</ai-hint>
    [Parameter]
    [AIParameter(Hint = "Use for presence indicators in chat, team lists, user directories")]
    public bool ShowStatus { get; set; }
    
    /// <summary>Status state for presence indicator</summary>
    /// <ai-hint>Online for active users, Away for inactive, Busy for do-not-disturb, Offline for unavailable</ai-hint>
    [Parameter]
    [AIParameter(Hint = "Online for active, Away for inactive, Busy for do-not-disturb, Offline for unavailable", 
                 SuggestedValues = new[] { "Online", "Away", "Busy", "Offline" })]
    public AvatarStatus Status { get; set; } = AvatarStatus.None;
    
    /// <summary>Whether to show notification badge with count</summary>
    /// <ai-hint>Use for unread message counts, notification indicators, or pending items</ai-hint>
    [Parameter]
    [AIParameter(Hint = "Use for unread message counts, notification indicators, pending items")]
    public bool ShowBadge { get; set; }
    
    /// <summary>Badge count number displayed in notification badge</summary>
    /// <ai-hint>Shows actual count, displays "99+" for values over 99</ai-hint>
    [Parameter]
    [AIParameter(Hint = "Shows actual count, displays 99+ for values over 99")]
    public int BadgeCount { get; set; }
    
    /// <summary>Whether avatar is clickable - adds hover effects and cursor pointer</summary>
    /// <ai-hint>Set to true for interactive avatars that open profiles, menus, or perform actions</ai-hint>
    [Parameter]
    [AIParameter(Hint = "Set to true for interactive avatars that open profiles or menus")]
    public bool IsClickable { get; set; }
    
    /// <summary>Additional CSS classes</summary>
    [Parameter] public string Class { get; set; }
    
    /// <summary>Click event handler</summary>
    [Parameter] public EventCallback<MouseEventArgs> OnClick { get; set; }
    
    private string GetAvatarClasses()
    {
        var classes = new List<string>
        {
            "relative",
            "flex",
            "align-center",
            "justify-center",
            "overflow-hidden",
            "flex-shrink-0"
        };
        
        // Size classes
        classes.Add(Size switch
        {
            AvatarSize.ExtraSmall => "w-6 h-6 text-xs",
            AvatarSize.Small => "w-8 h-8 text-sm",
            AvatarSize.Medium => "w-12 h-12 text-base",
            AvatarSize.Large => "w-16 h-16 text-lg",
            AvatarSize.ExtraLarge => "w-20 h-20 text-xl",
            _ => "w-12 h-12 text-base"
        });
        
        // Shape - always circular for avatars
        classes.Add("rounded-full");
        
        // Variant styles
        switch (Variant)
        {
            case AvatarVariant.Default:
                classes.AddRange(new[] { "bg-secondary", "text-primary", "border-2", "border-medium" });
                break;
                
            case AvatarVariant.Primary:
                classes.AddRange(new[] { "bg-primary", "text-inverse", "border-2", "border-primary" });
                break;
                
            case AvatarVariant.Success:
                classes.AddRange(new[] { "bg-success", "text-inverse", "border-2", "border-success" });
                break;
                
            case AvatarVariant.Warning:
                classes.AddRange(new[] { "bg-warning", "text-inverse", "border-2", "border-warning" });
                break;
                
            case AvatarVariant.Error:
                classes.AddRange(new[] { "bg-error", "text-inverse", "border-2", "border-error" });
                break;
                
            case AvatarVariant.Gradient:
                classes.AddRange(new[] { "bg-gradient-primary", "text-inverse", "border-2", "border-primary" });
                break;
        }
        
        // Interactive states
        if (IsClickable)
        {
            classes.AddRange(new[] { "cursor-pointer", "hover:opacity-80", "transition" });
        }
        
        if (!string.IsNullOrEmpty(Class))
        {
            classes.Add(Class);
        }
        
        return string.Join(" ", classes);
    }
    
    private string GetImageClasses()
    {
        return "w-full h-full object-cover";
    }
    
    private string GetIconClasses()
    {
        return Size switch
        {
            AvatarSize.ExtraSmall => "text-xs",
            AvatarSize.Small => "text-sm",
            AvatarSize.Medium => "text-lg",
            AvatarSize.Large => "text-2xl",
            AvatarSize.ExtraLarge => "text-3xl",
            _ => "text-lg"
        };
    }
    
    private string GetTextClasses()
    {
        return "font-bold uppercase";
    }
    
    private string GetStatusClasses()
    {
        var classes = new List<string>
        {
            "absolute",
            "rounded-full",
            "border-2",
            "border-white"
        };
        
        // Size based on avatar size
        classes.Add(Size switch
        {
            AvatarSize.ExtraSmall => "w-2 h-2 -bottom-0 -right-0",
            AvatarSize.Small => "w-3 h-3 -bottom-0 -right-0",
            AvatarSize.Medium => "w-4 h-4 -bottom-1 -right-1",
            AvatarSize.Large => "w-5 h-5 -bottom-1 -right-1",
            AvatarSize.ExtraLarge => "w-6 h-6 -bottom-2 -right-2",
            _ => "w-4 h-4 -bottom-1 -right-1"
        });
        
        // Status color
        classes.Add(Status switch
        {
            AvatarStatus.Online => "bg-success",
            AvatarStatus.Away => "bg-warning",
            AvatarStatus.Busy => "bg-error",
            AvatarStatus.Offline => "bg-secondary",
            _ => "bg-secondary"
        });
        
        return string.Join(" ", classes);
    }
    
    private string GetBadgeClasses()
    {
        var classes = new List<string>
        {
            "absolute",
            "bg-error",
            "text-inverse",
            "text-xs",
            "font-bold",
            "rounded-full",
            "flex",
            "align-center",
            "justify-center",
            "min-w-4",
            "h-4",
            "pl-1 pr-1"
        };
        
        // Position based on avatar size
        classes.Add(Size switch
        {
            AvatarSize.ExtraSmall => "-top-1 -right-1",
            AvatarSize.Small => "-top-1 -right-1",
            AvatarSize.Medium => "-top-2 -right-2",
            AvatarSize.Large => "-top-2 -right-2",
            AvatarSize.ExtraLarge => "-top-3 -right-3",
            _ => "-top-2 -right-2"
        });
        
        return string.Join(" ", classes);
    }
    
    private async Task HandleClick(MouseEventArgs e)
    {
        if (IsClickable)
        {
            await OnClick.InvokeAsync(e);
        }
    }
}

