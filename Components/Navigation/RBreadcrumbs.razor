@namespace RR.Blazor.Components
@using RR.Blazor.Models
@using RR.Blazor.Enums

<nav class="breadcrumbs @GetBreadcrumbsClasses()" aria-label="Breadcrumb">
    <ol class="breadcrumbs__list">
        @if (Items?.Any() == true)
        {
            @foreach (var item in Items)
            {
                var isLast = item == Items.Last();
                
                <li class="breadcrumbs__item">
                    @if (!string.IsNullOrEmpty(item.Icon))
                    {
                        <i class="material-symbols-rounded breadcrumbs__icon">@item.Icon</i>
                    }
                    
                    @if (isLast || string.IsNullOrEmpty(item.Href))
                    {
                        <span class="breadcrumbs__text @(isLast ? "breadcrumbs__text--current" : "")" 
                              aria-current="@(isLast ? "page" : null)">
                            @item.Text
                        </span>
                    }
                    else
                    {
                        <a href="@item.Href" class="breadcrumbs__link">
                            @item.Text
                        </a>
                    }
                    
                    @if (!isLast)
                    {
                        <span class="breadcrumbs__separator" aria-hidden="true">
                            @if (!string.IsNullOrEmpty(Separator))
                            {
                                @Separator
                            }
                            else if (!string.IsNullOrEmpty(SeparatorIcon))
                            {
                                <i class="material-symbols-rounded">@SeparatorIcon</i>
                            }
                            else
                            {
                                <i class="material-symbols-rounded">chevron_right</i>
                            }
                        </span>
                    }
                </li>
            }
        }
        else if (ChildContent != null)
        {
            @ChildContent
        }
    </ol>
</nav>

@code {
    /// <summary>Breadcrumb items</summary>
    [Parameter] public List<BreadcrumbItem> Items { get; set; }
    
    /// <summary>Size variant</summary>
    [Parameter] public BreadcrumbSize Size { get; set; } = BreadcrumbSize.Default;
    
    /// <summary>Custom separator text (default: chevron icon)</summary>
    [Parameter] public string Separator { get; set; }
    
    /// <summary>Custom separator icon</summary>
    [Parameter] public string SeparatorIcon { get; set; }
    
    /// <summary>Whether to collapse items on mobile</summary>
    [Parameter] public bool CollapsibleOnMobile { get; set; } = true;
    
    /// <summary>Max items to show before collapsing</summary>
    [Parameter] public int MaxVisibleItems { get; set; } = 0;
    
    /// <summary>Additional CSS classes</summary>
    [Parameter] public string Class { get; set; }
    
    /// <summary>Custom content</summary>
    [Parameter] public RenderFragment ChildContent { get; set; }
    
    /// <summary>Additional HTML attributes</summary>
    [Parameter(CaptureUnmatchedValues = true)] public Dictionary<string, object> AdditionalAttributes { get; set; }
    
    private string GetBreadcrumbsClasses()
    {
        var classes = new List<string> { "breadcrumbs" };
        
        // Size variant
        if (Size != BreadcrumbSize.Default)
        {
            classes.Add($"breadcrumbs--{Size.ToString().ToLower()}");
        }
        
        // Collapsible on mobile
        if (CollapsibleOnMobile)
        {
            classes.Add("breadcrumbs--collapsible");
        }
        
        // Custom CSS classes
        if (!string.IsNullOrEmpty(Class))
        {
            classes.Add(Class);
        }
        
        return string.Join(" ", classes);
    }
}

@* Usage Examples:

<!-- Basic breadcrumbs -->
<RBreadcrumbs Items="@breadcrumbItems" />

<!-- With custom separator -->
<RBreadcrumbs Items="@breadcrumbItems" Separator=" / " />

<!-- Small size -->
<RBreadcrumbs Items="@breadcrumbItems" Size="BreadcrumbSize.Small" />

<!-- Custom content -->
<RBreadcrumbs>
    <li class="breadcrumbs__item">
        <a href="/" class="breadcrumbs__link">Home</a>
        <span class="breadcrumbs__separator">/</span>
    </li>
    <li class="breadcrumbs__item">
        <span class="breadcrumbs__text breadcrumbs__text--current">Current Page</span>
    </li>
</RBreadcrumbs>

@code {
    List<BreadcrumbItem> breadcrumbItems = new()
    {
        new() { Text = "Home", Href = "/", Icon = "home" },
        new() { Text = "Products", Href = "/products" },
        new() { Text = "Electronics", Href = "/products/electronics" },
        new() { Text = "Laptops" }
    };
}
*@