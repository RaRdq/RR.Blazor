@page "/test/skeleton-overlay"
@using RR.Blazor.Enums
@using RR.Blazor.Components.Display

<PageTitle>Skeleton Smart Overlay Test</PageTitle>

<RAppShell Header="RSkeleton Smart Overlay Test" Features="AppShellFeatures.All">
    <RContent>
        <div class="container-px-4">
            <RSection Text="Smart Skeleton Overlay Test" Icon="auto_awesome" Class="mb-6">
                <p class="text-muted mb-0">Testing RSkeleton smart mode that overlays skeleton on top of content instead of appearing next to it.</p>
            </RSection>

            <!-- Test 1: Smart Mode with Glass Effect -->
            <RCard Text="Smart Mode with Glass Effect" Subtitle="Skeleton should overlay content, not appear beside it" Variant="CardVariant.Elevated" Class="mb-4">
                <div class="pa-4">
                    <div class="d-flex gap-2 mb-4">
                        <RButton Text="Toggle Loading" Variant="ButtonVariant.Primary" OnClick="@(() => smartLoading1 = !smartLoading1)" />
                        <RButton Text="Toggle Glass" Variant="ButtonVariant.Secondary" OnClick="@(() => useGlass1 = !useGlass1)" />
                    </div>
                    
                    <RSkeleton Loading="@smartLoading1" UseGlassEffect="@useGlass1">
                        <div class="pa-4 bg-surface-elevated rounded">
                            <h3 class="text-h5 font-semibold mb-3">Employee Dashboard</h3>
                            <p class="text-body-1 text-muted mb-4">This content is hidden behind the skeleton overlay when loading is true. The skeleton should completely cover this content, not appear next to it.</p>
                            <div class="d-flex gap-2">
                                <RChip Text="Active" Style="ChipStyle.Badge" Variant="ChipVariant.Success" />
                                <RChip Text="Manager" Style="ChipStyle.Badge" Variant="ChipVariant.Primary" />
                            </div>
                        </div>
                    </RSkeleton>
                </div>
            </RCard>

            <!-- Test 2: Smart Mode in Different Containers -->
            <div class="d-grid grid-cols-1 grid-cols-md-2 gap-4 mb-4">
                <RCard Text="In Card Container" Variant="CardVariant.Outlined">
                    <div class="pa-4">
                        <RButton Text="Toggle" Size="ButtonSize.Small" Class="mb-3" OnClick="@(() => smartLoading2 = !smartLoading2)" />
                        
                        <RSkeleton Loading="@smartLoading2">
                            <RInfoItem Text="Employee Name" Value="Sarah Johnson" Icon="person" />
                            <RInfoItem Text="Department" Value="Engineering" Icon="engineering" />
                            <RInfoItem Text="Status" Value="Active" Icon="check_circle" />
                        </RSkeleton>
                    </div>
                </RCard>
                
                <RCard Text="In Modal-like Container" Variant="CardVariant.Glass">
                    <div class="pa-4">
                        <RButton Text="Toggle" Size="ButtonSize.Small" Class="mb-3" OnClick="@(() => smartLoading3 = !smartLoading3)" />
                        
                        <RSkeleton Loading="@smartLoading3" UseGlassEffect="true">
                            <div class="text-center">
                                <RAvatar Text="SJ" Size="AvatarSize.Large" Variant="AvatarVariant.Primary" Class="mx-auto mb-3" />
                                <h4 class="text-h6 font-semibold">Sarah Johnson</h4>
                                <p class="text-muted">Senior Developer</p>
                            </div>
                        </RSkeleton>
                    </div>
                </RCard>
            </div>

            <!-- Test 3: Manual Skeleton Types -->
            <RCard Text="Manual Skeleton Types" Subtitle="Different skeleton patterns for various content types" Variant="CardVariant.Elevated" Class="mb-4">
                <div class="pa-4">
                    <div class="d-grid grid-cols-1 grid-cols-md-3 gap-4">
                        <div>
                            <h5 class="text-subtitle-1 font-semibold mb-2">Card Skeleton</h5>
                            <RSkeleton Type="SkeletonType.Card" SmartMode="false" Loading="@manualLoading" />
                        </div>
                        
                        <div>
                            <h5 class="text-subtitle-1 font-semibold mb-2">Avatar Skeleton</h5>
                            <RSkeleton Type="SkeletonType.Avatar" SmartMode="false" Loading="@manualLoading" />
                        </div>
                        
                        <div>
                            <h5 class="text-subtitle-1 font-semibold mb-2">Text Skeleton</h5>
                            <RSkeleton Type="SkeletonType.Text" Count="3" SmartMode="false" Loading="@manualLoading" />
                        </div>
                    </div>
                    
                    <RButton Text="Toggle Manual Skeletons" Variant="ButtonVariant.Outline" Class="mt-4" OnClick="@(() => manualLoading = !manualLoading)" />
                </div>
            </RCard>

            <!-- Test 4: Complex Content with Smart Detection -->
            <RCard Text="Complex Content Smart Detection" Subtitle="Testing skeleton with various content types" Variant="CardVariant.Elevated" Class="mb-4">
                <div class="pa-4">
                    <RButton Text="Toggle Complex Loading" Variant="ButtonVariant.Primary" Class="mb-4" OnClick="@(() => complexLoading = !complexLoading)" />
                    
                    <RSkeleton Loading="@complexLoading">
                        <div class="d-grid grid-cols-1 grid-cols-md-2 gap-4">
                            <div>
                                <h4 class="text-h6 font-semibold mb-2">Project Overview</h4>
                                <p class="text-body-2 text-muted mb-3">
                                    This is a complex layout with multiple elements that should be properly covered by the skeleton overlay.
                                </p>
                                <RProgressBar Value="75" Text="Project Progress" Variant="ProgressVariant.Success" />
                            </div>
                            
                            <div>
                                <RStatsCard Text="Total Revenue" Value="$125,430" Icon="attach_money" />
                                <div class="mt-3">
                                    <RBadge Text="On Track" Variant="BadgeVariant.Success" />
                                </div>
                            </div>
                        </div>
                    </RSkeleton>
                </div>
            </RCard>

            <!-- Test 5: Side-by-side comparison -->
            <RCard Text="Before/After Comparison" Subtitle="Shows the difference between broken and fixed behavior" Variant="CardVariant.Glass" Class="mb-4">
                <div class="pa-4">
                    <div class="d-grid grid-cols-1 grid-cols-md-2 gap-6">
                        <div>
                            <h5 class="text-subtitle-1 font-semibold text-error mb-3">❌ Old Behavior (Simulated)</h5>
                            <div class="d-flex gap-2 bg-surface-variant pa-3 rounded">
                                <div class="skeleton skeleton-text w-100"></div>
                                <div class="pa-3 bg-surface-elevated rounded">
                                    <p class="text-sm">Content appears next to skeleton</p>
                                </div>
                            </div>
                        </div>
                        
                        <div>
                            <h5 class="text-subtitle-1 font-semibold text-success mb-3">✅ New Behavior (Fixed)</h5>
                            <RSkeleton Loading="true">
                                <div class="pa-3 bg-surface-elevated rounded">
                                    <p class="text-sm">Content is properly overlaid by skeleton</p>
                                </div>
                            </RSkeleton>
                        </div>
                    </div>
                </div>
            </RCard>

            <!-- Summary -->
            <RCard Text="Implementation Summary" Variant="CardVariant.Elevated">
                <div class="pa-4">
                    <RList Header="Key Improvements" Variant="ListVariant.Default">
                        <RListItem Text="Smart overlay properly covers content instead of appearing beside it" Icon="check_circle" />
                        <RListItem Text="Container-agnostic design works in any parent container" Icon="check_circle" />
                        <RListItem Text="Glass effect integration for premium loading states" Icon="check_circle" />
                        <RListItem Text="Follows SCSS_REFACTOR_PLAN.md architecture" Icon="check_circle" />
                        <RListItem Text="Extracted to dedicated _skeleton.scss component file" Icon="check_circle" />
                        <RListItem Text="Full accessibility and reduced motion support" Icon="check_circle" />
                    </RList>
                </div>
            </RCard>
        </div>
    </RContent>
</RAppShell>

@code {
    private bool smartLoading1 = true;
    private bool useGlass1 = false;
    private bool smartLoading2 = true;
    private bool smartLoading3 = true;
    private bool manualLoading = true;
    private bool complexLoading = true;
}