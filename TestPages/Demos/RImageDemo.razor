@using RR.Blazor.Components.Core
@using RR.Blazor.Components.Display
@using RR.Blazor.Components.Feedback
@using RR.Blazor.Enums
@using RR.Blazor.TestPages.Demos.Components

<div class="relative">
    <GitHubLinkButton FileName="RImageDemo.razor" />
    <RCard Variant="CardVariant.Outlined" Text="RImage">
    <ChildContent>
        <RDivider Text="Image Component" 
                  Subtitle="Enterprise-grade image component with lazy loading and progressive enhancement" 
                  Icon="image" />
        
        <div class="space-y-6">
            <!-- Image Variants -->
            <div class="space-y-2">
                <div class="text-h6 font-semibold">Image Variants</div>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 p-4">
                    <div class="text-center">
                        <RImage Src="https://picsum.photos/seed/default/200/200"
                                Alt="Default image"
                                Variant="ImageVariant.Default"
                                Width="200"
                                Height="200"
                                 />
                        <p class="text-sm text-muted mt-2">Default</p>
                    </div>
                    <div class="text-center">
                        <RImage Src="https://picsum.photos/seed/circle/200/200"
                                Alt="Circle image"
                                Variant="ImageVariant.Circle"
                                Width="200"
                                Height="200"
                                 />
                        <p class="text-sm text-muted mt-2">Circle</p>
                    </div>
                    <div class="text-center">
                        <RImage Src="https://picsum.photos/seed/rounded/200/200"
                                Alt="Rounded image"
                                Variant="ImageVariant.Rounded"
                                Width="200"
                                Height="200"
                                 />
                        <p class="text-sm text-muted mt-2">Rounded</p>
                    </div>
                    <div class="text-center">
                        <RImage Src="https://picsum.photos/seed/thumbnail/200/200"
                                Alt="Thumbnail image"
                                Variant="ImageVariant.Thumbnail"
                                Width="200"
                                Height="200"
                                 />
                        <p class="text-sm text-muted mt-2">Thumbnail</p>
                    </div>
                </div>
            </div>

            <!-- Interactive Examples -->
            <div class="space-y-2">
                <div class="text-h6 font-semibold">Interactive Images</div>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 p-4">
                    <RCard Variant="CardVariant.Elevated">
                        <h4 class="text-h6 mb-3">Clickable with Overlay</h4>
                        <RImage Src="https://picsum.photos/seed/interactive1/400/300"
                                Alt="Interactive image with overlay"
                                EnableOverlay="true"
                                OverlayText="Click to view details"
                                OnClick="@(() => HandleImageClick("Image 1"))"
                                Width="400"
                                Height="300"
                                Class="cursor-pointer" />
                        @if (!string.IsNullOrEmpty(_clickedImage))
                        {
                            <RAlert Type="AlertType.Info" Class="mt-3">
                                You clicked: @_clickedImage
                            </RAlert>
                        }
                    </RCard>
                    
                    <RCard Variant="CardVariant.Elevated">
                        <h4 class="text-h6 mb-3">Lazy Loading with Skeleton</h4>
                        <RImage Src="https://picsum.photos/seed/lazy/400/300"
                                Alt="Lazy loaded image"
                                LazyLoading="true"
                                ShowSkeleton="true"
                                SkeletonText="Loading high-quality image..."
                                Width="400"
                                Height="300" />
                    </RCard>
                </div>
            </div>

            <!-- Object Fit Options -->
            <div class="space-y-2">
                <div class="text-h6 font-semibold">Object Fit Options</div>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4 p-4">
                    <RCard>
                        <h4 class="text-subtitle mb-2">Cover</h4>
                        <div class="border rounded" style="width: 100%; height: 200px; overflow: hidden;">
                            <RImage Src="https://picsum.photos/seed/cover/600/400"
                                    Alt="Cover fit"
                                    ObjectFit="ObjectFit.Cover"
                                    FullWidth="true"
                                        Style="height: 100%;" />
                        </div>
                    </RCard>
                    
                    <RCard>
                        <h4 class="text-subtitle mb-2">Contain</h4>
                        <div class="border rounded" style="width: 100%; height: 200px; overflow: hidden;">
                            <RImage Src="https://picsum.photos/seed/contain/600/400"
                                    Alt="Contain fit"
                                    ObjectFit="ObjectFit.Contain"
                                    FullWidth="true"
                                        Style="height: 100%;" />
                        </div>
                    </RCard>
                    
                    <RCard>
                        <h4 class="text-subtitle mb-2">Fill</h4>
                        <div class="border rounded" style="width: 100%; height: 200px; overflow: hidden;">
                            <RImage Src="https://picsum.photos/seed/fill/600/400"
                                    Alt="Fill fit"
                                    ObjectFit="ObjectFit.Fill"
                                    FullWidth="true"
                                        Style="height: 100%;" />
                        </div>
                    </RCard>
                </div>
            </div>

            <!-- Placeholder Options -->
            <div class="space-y-2">
                <div class="text-h6 font-semibold">Placeholder Image Options</div>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4 p-4">
                    <RCard>
                        <h4 class="text-subtitle mb-2">Grayscale</h4>
                        <RImage UsePlaceholder="true"
                                PlaceholderGrayscale="true"
                                PlaceholderSeed="grayscale"
                                Alt="Grayscale image"
                                Width="300"
                                Height="200"
                                 />
                    </RCard>
                    
                    <RCard>
                        <h4 class="text-subtitle mb-2">Blurred</h4>
                        <RImage UsePlaceholder="true"
                                PlaceholderBlur="3"
                                PlaceholderSeed="blurred"
                                Alt="Blurred image"
                                Width="300"
                                Height="200"
                                 />
                    </RCard>
                    
                    <RCard>
                        <h4 class="text-subtitle mb-2">Seeded (Consistent)</h4>
                        <RImage UsePlaceholder="true"
                                PlaceholderSeed="consistent"
                                Alt="Seeded image"
                                Width="300"
                                Height="200"
                                 />
                    </RCard>
                </div>
            </div>

            <!-- Responsive Images -->
            <div class="space-y-2">
                <div class="text-h6 font-semibold">Responsive Images</div>
                <RCard Variant="CardVariant.Elevated">
                    <h4 class="text-subtitle mb-3">Full Width with Aspect Ratio</h4>
                    <RImage Src="https://picsum.photos/seed/responsive/1920/600"
                            Alt="Responsive image"
                            FullWidth="true"
                            AspectRatio="16/5"
                            LazyLoading="true"
                            ShowSkeleton="true" />
                </RCard>
            </div>

            <!-- Error Handling -->
            <div class="space-y-2">
                <div class="text-h6 font-semibold">Error Handling</div>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 p-4">
                    <RCard>
                        <h4 class="text-subtitle mb-2">Error with Fallback</h4>
                        <RImage Src="https://invalid-url-that-does-not-exist.com/image.jpg"
                                Alt="Image with error"
                                ErrorSrc="https://picsum.photos/seed/error/300/200?grayscale"
                                Width="300"
                                Height="200" />
                        <p class="text-sm text-muted mt-2">Falls back to grayscale image on error</p>
                    </RCard>
                    
                    <RCard>
                        <h4 class="text-subtitle mb-2">Priority Loading</h4>
                        <RImage Src="https://picsum.photos/seed/priority/300/200"
                                Alt="Priority image"
                                Priority="true"
                                Width="300"
                                Height="200" />
                        <p class="text-sm text-muted mt-2">Loads immediately without lazy loading</p>
                    </RCard>
                </div>
            </div>
        </div>
    </ChildContent>
</RCard>
</div>

@code {
    private string _clickedImage = "";
    
    private void HandleImageClick(string imageName)
    {
        _clickedImage = imageName;
        StateHasChanged();
        
        Task.Run(async () =>
        {
            await Task.Delay(3000);
            _clickedImage = "";
            await InvokeAsync(StateHasChanged);
        });
    }
}