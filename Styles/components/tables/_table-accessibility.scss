@use '../../abstracts' as *;
@use 'table-mixins' as mixins;

@layer components {

.table {

  @media (prefers-contrast: high) {
    --table-border: var(--color-text);
    --table-header-border: var(--color-text);
    --table-cell-border: var(--color-text);
    --table-row-selected-border: var(--color-text);

    &-header-cell {
      border: var(--border-width-regular) solid var(--color-text);
      background: var(--canvas);
      color: var(--color-text);
    }

    &-cell {
      border: var(--border-width-thin) solid var(--color-text);
    }

    tbody tr:hover {
      background: var(--color-text);
      color: var(--canvas);
    }
  }

&-container {

    @media (prefers-reduced-motion: reduce) {
      .skeleton-cell::after {
        animation: none;
      }

      .empty-icon {
        animation: none;
      }
    }
  }
}

@layer overrides {
  @media (prefers-reduced-motion: reduce) {
    * {
      animation-duration: 0.01ms !important;
      animation-iteration-count: 1 !important;
      transition-duration: 0.01ms !important;
      scroll-behavior: auto !important;
    }
  }

  .table {
    &-header-cell {
      @include mixins.table-focus-visible;

&[aria-sort="ascending"] {
        @include mixins.sr-content(" (sorted ascending)");
      }

      &[aria-sort="descending"] {
        @include mixins.sr-content(" (sorted descending)");
      }
    }

    &-cell {
      &:focus-visible {
        outline: var(--border-width-regular) solid var(--color-primary);
        outline-offset: -2px;
        box-shadow: 0 0 0 4px var(--color-primary-light);
        z-index: var(--z-floating);
        position: relative;
      }

      @include mixins.table-tooltip-hover;
    }
  }

.table {
    &-cell {
      &:focus-visible {
        outline: var(--border-width-regular) solid var(--color-primary);
        outline-offset: -2px;
        box-shadow: 0 0 0 4px var(--color-primary-light);
        z-index: var(--z-floating);
        position: relative;
      }
    }

    &-header {
      &-cell.table-header-resizable {

        &:focus-within {
          overflow: visible;
          z-index: var(--z-floating);
          position: relative;

          &::after {
            content: attr(title);
            position: absolute;
            top: 100%;
            left: 0;
            background: var(--surface-elevated);
            color: var(--color-text);
            padding: var(--space-2) var(--space-3);
            border-radius: var(--radius-sm);
            box-shadow: var(--shadow-lg);
            white-space: normal;
            max-width: 300px;
            z-index: var(--z-tooltip);
            border: 1px solid var(--border);
          }
        }
      }
    }

    &-loading-skeleton {
      &[aria-live="polite"] {
        .skeleton-row:first-child::before {
          content: "Loading table data";
          position: absolute;
          left: -10000px;
          width: 1px;
          height: 1px;
          overflow: hidden;
        }
      }
    }
  }

  tbody tr {
    @include mixins.table-focus-visible;

    &[aria-selected="true"] {
      background: var(--color-primary-light);
      border-left: calc(var(--border-width-regular) * 2) solid var(--color-primary);

      .table-cell,
      .table-cell {
        background: transparent;
      }
    }
  }

input[type="checkbox"],
  input[type="radio"] {
    &:focus-visible {
      outline: var(--border-width-thick) solid var(--color-primary);
      outline-offset: 2px;
    }

@media (prefers-contrast: high) {
      border: var(--border-width-regular) solid var(--color-text);

      &:checked {
        background: var(--color-text);
        border-color: var(--color-text);
      }
    }
  }
}

}
